



<!DOCTYPE html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      <meta http-equiv="x-ua-compatible" content="ie=edge">
      
      
      
      
        <meta name="lang:clipboard.copy" content="Copy to clipboard">
      
        <meta name="lang:clipboard.copied" content="Copied to clipboard">
      
        <meta name="lang:search.language" content="en">
      
        <meta name="lang:search.pipeline.stopwords" content="True">
      
        <meta name="lang:search.pipeline.trimmer" content="True">
      
        <meta name="lang:search.result.none" content="No matching documents">
      
        <meta name="lang:search.result.one" content="1 matching document">
      
        <meta name="lang:search.result.other" content="# matching documents">
      
        <meta name="lang:search.tokenizer" content="[\s\-]+">
      
      <link rel="shortcut icon" href="../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-0.17.3, mkdocs-material-2.7.3">
    
    
      
        <title>Installation - Π4U</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/application.8d40d89b.css">
      
        <link rel="stylesheet" href="../assets/stylesheets/application-palette.6079476c.css">
      
    
    
      <script src="../assets/javascripts/modernizr.1aa3b519.js"></script>
    
    
      <link href="https://fonts.gstatic.com" rel="preconnect" crossorigin>
      
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700|Roboto+Mono">
        <style>body,input{font-family:"Roboto","Helvetica Neue",Helvetica,Arial,sans-serif}code,kbd,pre{font-family:"Roboto Mono","Courier New",Courier,monospace}</style>
      
      <link rel="stylesheet" href="https://fonts.googleapis.com/icon?family=Material+Icons">
    
    
    
  </head>
  
    
    
    <body dir="ltr" data-md-color-primary="indigo" data-md-color-accent="indigo">
  
    <svg class="md-svg">
      <defs>
        
        
      </defs>
    </svg>
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="search" autocomplete="off">
    <label class="md-overlay" data-md-component="overlay" for="drawer"></label>
    
      <a href="#software-components" tabindex="1" class="md-skip">
        Skip to content
      </a>
    
    
      <header class="md-header" data-md-component="header">
  <nav class="md-header-nav md-grid">
    <div class="md-flex">
      <div class="md-flex__cell md-flex__cell--shrink">
        <a href=".." title="Π4U" class="md-header-nav__button md-logo">
          
            <i class="md-icon"></i>
          
        </a>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        <label class="md-icon md-icon--menu md-header-nav__button" for="drawer"></label>
      </div>
      <div class="md-flex__cell md-flex__cell--stretch">
        <div class="md-flex__ellipsis md-header-nav__title" data-md-component="title">
          
            
              <span class="md-header-nav__topic">
                Π4U
              </span>
              <span class="md-header-nav__topic">
                Installation
              </span>
            
          
        </div>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        
          
            <label class="md-icon md-icon--search md-header-nav__button" for="search"></label>
            
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="query" data-md-state="active">
      <label class="md-icon md-search__icon" for="search"></label>
      <button type="reset" class="md-icon md-search__icon" data-md-component="reset" tabindex="-1">
        &#xE5CD;
      </button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="result">
          <div class="md-search-result__meta">
            Type to start searching
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
          
        
      </div>
      
    </div>
  </nav>
</header>
    
    <div class="md-container">
      
        
      
      
      <main class="md-main">
        <div class="md-main__inner md-grid" data-md-component="container">
          
            
              <div class="md-sidebar md-sidebar--primary" data-md-component="navigation">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    <nav class="md-nav md-nav--primary" data-md-level="0">
  <label class="md-nav__title md-nav__title--site" for="drawer">
    <span class="md-nav__button md-logo">
      
        <i class="md-icon"></i>
      
    </span>
    Π4U
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      


  <li class="md-nav__item">
    <a href=".." title="Home" class="md-nav__link">
      Home
    </a>
  </li>

    
      
      
      

  


  <li class="md-nav__item md-nav__item--active">
    
    <input class="md-toggle md-nav__toggle" data-md-toggle="toc" type="checkbox" id="toc">
    
      
    
    
    <a href="./" title="Installation" class="md-nav__link md-nav__link--active">
      Installation
    </a>
    
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-3" type="checkbox" id="nav-3">
    
    <label class="md-nav__link" for="nav-3">
      Examples
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-3">
        Examples
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../examples/sampling/" title="Sampling" class="md-nav__link">
      Sampling
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../examples/post/" title="Postprocessing" class="md-nav__link">
      Postprocessing
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../developing/" title="Developing" class="md-nav__link">
      Developing
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../hpc/" title="Performance and Scalability" class="md-nav__link">
      Performance and Scalability
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../references/" title="References" class="md-nav__link">
      References
    </a>
  </li>

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              <div class="md-sidebar md-sidebar--secondary" data-md-component="toc">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary">
  
  
    
  
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content">
            <article class="md-content__inner md-typeset">
              
                
                
                <h1 id="software-components">SOFTWARE COMPONENTS</h1>
<p>You will find the following software packages:</p>
<ul>
<li>torc_lite: a tasking library that allows us to write platform-independent code</li>
<li>pndl: parallel numerical differentiation library, built on top of torc_lite</li>
<li>engines: the UQ framework built on top of torc_lite. </li>
</ul>
<h1 id="prerequisites">PREREQUISITES</h1>
<ul>
<li>An MPI implementation must be installed on your system (preferably with full thread safety)</li>
<li>GSL (http://www.gnu.org/software/gsl/) is required by some engines and must be installed on your system</li>
</ul>
<h1 id="installation-steps">INSTALLATION STEPS</h1>
<p>1) First we start with torc_lite. We assume that the MPI compiler is named mpicc.
    cd torc_lite
    ./configure CC=mpicc --prefix=<span><span class="MathJax_Preview">HOME/usr/torc
    make; make install
    export PATH=</span><script type="math/tex">HOME/usr/torc
    make; make install
    export PATH=</script></span>HOME/usr/torc/bin:$PATH</p>
<p>If configure reports missing files, you will need to execute the autoreconf command (autoreconf) before executing ./configure </p>
<p>In $HOME/usr/torc/bin there are two files (torc_cflags, torc_libs) that facilitate the development of torc-based programs.
   That's why we have added this directory to the PATH environment variable using the export (bash) command. </p>
<p>After finishing this step, you must be able to run successfully at least one of the demo examples, available in torc/examples</p>
<p>2) We then proceed with the compilation of the various engines (algorithms) of our Uncertainty Quantification and Optimization framework.
   For example, to build the code that implements the TMCMC algorithm:</p>
<pre><code>cd inference/TMCMC
make
</code></pre>
<p>If there are compilation issues then some directories in Makefile might need to be revised.
   For example, the exact location of the GSL library must be specificed.
   Moreover on some platforms, the MPI compiler can be named differently (e.g. CC=cc on Piz Daint).</p>
<p>The following compilation options are supported:
    - make use_omp=1        # builds the OpenMP version
    - make use_torc=1       # builds the TORC-based version 
    - make use_omp=0 use_torc=0 # builds the serial version
    - make              # default option is use_omp=1</p>
<h1 id="testing">TESTING</h1>
<p>1) inference/TMCMC</p>
<p>The TMCMC sampling algorithm</p>
<p>a) build engine_tmcmc</p>
<pre><code>cd inference/TMCMC
make
</code></pre>
<p>b) Run the engine
    ./engine_tmcmc</p>
<p>By default, this runs TMCMC for the rosenbrock function in 2D, as defined in fitfun.c 
   This is expected to run and produce some output files (curgen_db_000.txt, curgen_db_001.txt, ...)</p>
<p>The output files can be visualized with the display_gen tool, available in the display directory, using the following command:
    ./display_gen curgen_db 5 2
    5: number of the last generation (curgen_db_000.txt to curgen_db_005.txt will be displayed)
    2: problem dimension</p>
<pre><code>The runtime options for this engine can be set in the configuration file tmcmc.par
</code></pre>
<p>2) singleopt/CMAES</p>
<p>The CMAES stochastic optimization algorithm</p>
<p>a) Build the engine_cmaes</p>
<pre><code>cd singleopt/CMAES
make
</code></pre>
<p>b) Run the engine
    ./engine_cmaes</p>
<p>Optimization of the rosenbrock function in 2D.
   More information about the generated output files can be found in the documentation of CMAES.</p>
<p>3) rare/subset</p>
<p>Subset simulation </p>
<p>a) Build the two engines</p>
<pre><code>cd rare/subset
make
</code></pre>
<p>b) Run engine_ss1
    ./engine_ss1</p>
<p>Subset simulation for predefined levels
   This is expected to run and produce some output files (samples_000.txt etc)</p>
<p>The output files can be displayed with the display_gen tool, using the following command:
    ./display_gen samples 8 2
    8: number of the last generation (samples_000.txt to samples_008.txt will be displayed)
    2: problem dimension</p>
<p>The runtime options for this engine can be set in the configuration file subset.par</p>
<p>c) Run engine_ss2</p>
<pre><code>./engine_ss2
</code></pre>
<p>Same as before but for subset simulation with adaptive levels</p>
<p>4) Numerical differentiation</p>
<p>a) Build the parallel numerical differentiation library (PNDL).</p>
<pre><code>cd derivatives/pndl
./configure CC=mpicc F90=mpif90 
make
</code></pre>
<p>A README file with more detailed instructions is available along with the source code of PNDL. </p>
<p>b) Build the tools </p>
<pre><code>cd derivatives/tools
make
</code></pre>
<p>c) Run the tools</p>
<pre><code>./fd_grad
./fd_deriv
./sa_deriv
</code></pre>
<p>fd_grad: Calculation of the most suitable differentiation step per dimension using gradients and Romberg extrapolation <br />
   fd_deriv: Calculation of the gradient vector and Hessian matrix using PNDL 
   sa_deriv: Stochastic approximation of the Hessian matrix (experimental code)</p>
<p>Configuration file for all tools: grad.par</p>
<p>5) inference/abc-subsim</p>
<p>ABC-SUBSIM</p>
<p>Please check the README-ABC.txt file in the corresponding folder</p>
<h1 id="visualization">VISUALIZATION</h1>
<p>The display_gen tool, available in the display directority,  can visualize 2D slices of multidimensional data using gnuplot. </p>
<p>To build it:
    cd display
    make</p>
<p>The syntax can invoked as follows:
    ./display_gen <datafile> <last gen> <dimension> [var1] [var2]</p>
<pre><code>- The full name of the file is in the form: &lt;datafile&gt;_&lt;gen&gt;.txt, where gen = 000, 001, ..., &lt;last gen&gt;
- &lt;dimension&gt; is the number of parameters. This means that the datafile has &lt;dimension&gt;+1 columns, the last containing the result of the function evaluation
- [var1] and [var2] are optional arguments that specify the indices of the two parameters that will be displayed

Example:
./display_gen ../inference/TMCMC/curgen_db 4 2 1 2
</code></pre>
<h1 id="coupling-with-external-software">COUPLING WITH EXTERNAL SOFTWARE</h1>
<p>The coupling/ folder includes examples that demonstrate how external software can be called within a fitness function (fitfun)
   and coupled with any of the engines and tools available in the Pi4U framework.
   External software can include any kind of sequential or parallel code (OpenMP, MPI), 
   and be implemented in any possible programming language and environment (C/C++, Fortran, Python, Matlab). </p>
<p>Currently the following examples are included:</p>
<p>a) coupling/rosenbrock:
    A simple example; the Rosenbrock function now runs within the external sequential software.
    Passing of parameters is performed through the automatically created params.dat file</p>
<h1 id="notes">NOTES</h1>
<p>Do not hesitate to ask for help and report any problems at:
- chatzidp AT ethz.ch
- garampat AT ethz.ch</p>
                
                  
                
              
              
                


              
            </article>
          </div>
        </div>
      </main>
      
        
<footer class="md-footer">
  
    <div class="md-footer-nav">
      <nav class="md-footer-nav__inner md-grid">
        
          <a href=".." title="Home" class="md-flex md-footer-nav__link md-footer-nav__link--prev" rel="prev">
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-back md-footer-nav__button"></i>
            </div>
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  Previous
                </span>
                Home
              </span>
            </div>
          </a>
        
        
          <a href="../examples/sampling/" title="Sampling" class="md-flex md-footer-nav__link md-footer-nav__link--next" rel="next">
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  Next
                </span>
                Sampling
              </span>
            </div>
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-forward md-footer-nav__button"></i>
            </div>
          </a>
        
      </nav>
    </div>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
        powered by
        <a href="http://www.mkdocs.org">MkDocs</a>
        and
        <a href="https://squidfunk.github.io/mkdocs-material/">
          Material for MkDocs</a>
      </div>
      
        
      
    </div>
  </div>
</footer>
      
    </div>
    
      <script src="../assets/javascripts/application.b438e6c5.js"></script>
      
      <script>app.initialize({version:"0.17.3",url:{base:".."}})</script>
      
        <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js?config=TeX-MML-AM_CHTML"></script>
      
    
    
      
    
  </body>
</html>